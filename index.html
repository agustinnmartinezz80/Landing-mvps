<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Asesor√≠a Gratuita - MVP</title>
    <link rel="stylesheet" href="styles.css" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">

    <!-- Meta Pixel Code -->
    <script>
        !(function (f, b, e, v, n, t, s) {
            if (f.fbq) return;
            n = f.fbq = function () {
                n.callMethod ? n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n;
            n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = [];
            t = b.createElement(e); t.async = !0;
            t.src = v;
            s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s);
        })(window, document, 'script', 'https://connect.facebook.net/en_US/fbevents.js');

        fbq('init', '1125110379757394');
        fbq('track', 'PageView');
    </script>
    <noscript>
        <img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=1125110379757394&ev=PageView&noscript=1" />
    </noscript>
    <!-- End Meta Pixel Code -->
</head>

<body>
    <div class="container">
        <p class="subtitle">Tu proyecto en marcha en tiempo r√©cord</p>
        <h1 class="main-title">
            CONVIERTE TU IDEA<br>
            EN UN PROYECTO<br>
            <span class="highlight-glow-line">REAL, RENTABLE Y VIABLE</span>
        </h1>

        <div class="video-container">
            <video controls playsinline>
                <source src="Video-Explicacion.mp4" type="video/mp4">
                Tu navegador no soporta videos HTML5.
            </video>
        </div>

        <button class="cta-button" id="startQuiz">Asesor√≠a Gratuita</button>

        <div class="mvp-section">
            <p>Un MVP<br>
                <span class="tag-red">no es un producto incompleto</span><br>
                Es <span class="tag-green">espec√≠fico</span>
            </p>
            <hr>
            <p>Agenda y ent√©rate c√≥mo tener uno listo y funcional en <b>30 d√≠as</b></p>

            <details class="accordion">
                <summary>En tu diagn√≥stico vas a descubrir:</summary>
                <p>‚úÖ Si tu idea o proyecto tiene viabilidad t√©cnica y comercial.</p>
                <p>‚úÖ Una estimaci√≥n de inversi√≥n y tiempos realista.</p>
                <p>‚úÖ C√≥mo asegurar que el sistema pueda escalar sin rehacerse.</p>
                <p>‚úÖ Recomendaciones pr√°cticas seg√∫n el estado actual de tu negocio.</p>
            </details>

            <p class="note">*No es una reuni√≥n de venta. Es una conversaci√≥n para entender tu proyecto, analizarlo y
                darte claridad antes de avanzar.*</p>
        </div>

        <footer>@Pol√≠tica y privacidad</footer>
    </div>

    <!-- Modal -->
    <div class="modal" id="quizModal">
        <div class="modal-content" id="quizContent">
            <h3>Tipo de proyecto:</h3>
            <div class="options" id="options"></div>
            <button class="next-btn" id="nextBtn">Siguiente</button>
        </div>
    </div>

    <script>
    // Funci√≥n para trackear eventos personalizados
    function trackPixelEvent(eventName, customData = {}) {
        if (typeof fbq !== 'undefined') {
            fbq('trackCustom', eventName, customData);
            console.log('‚úÖ Evento trackeado:', eventName, customData);
        }
    }

    // Normalizar nombres para eventos
    function normalizeEventName(text) {
        return text.toLowerCase()
            .replace(/\s+/g, '-')
            .replace(/[^a-z0-9-]/g, '')
            .substring(0, 40);
    }

    // Obtener nombre legible del elemento
    function getUniqueQuestionName(element, fallback = 'pregunta') {
        return element.getAttribute('data-question-name') ||
            element.getAttribute('data-question') ||
            element.getAttribute('name') ||
            element.getAttribute('id') ||
            element.closest('.form-group')?.querySelector('label')?.textContent?.trim() ||
            element.closest('.field')?.querySelector('label')?.textContent?.trim() ||
            element.previousElementSibling?.textContent?.trim() ||
            fallback;
    }

    // Cuando el documento est√° listo
    document.addEventListener('DOMContentLoaded', function () {
        if (typeof fbq !== 'undefined') {
            fbq('track', 'ViewContent');
        }
        setupFormEvents();
        setupButtonEvents();
        setupSpecificEvents();
    });

    // Configurar eventos del formulario
    function setupFormEvents() {
        const forms = document.querySelectorAll('form');
        console.log('üîç Formularios encontrados:', forms.length);

        forms.forEach((form, formIndex) => {
            let respuestas = {}; // Guardamos todas las respuestas

            // SELECTS
            const selects = form.querySelectorAll('select');
            selects.forEach((select, selectIndex) => {
                const question = getUniqueQuestionName(select, `select-${selectIndex}`);
                select.addEventListener('change', function () {
                    const answer = this.options[this.selectedIndex]?.text || this.value;
                    if (answer && !answer.includes('Selecciona')) {
                        respuestas[question] = answer;
                        const eventName = `${normalizeEventName(question)}-${normalizeEventName(answer)}`;
                        trackPixelEvent(eventName, { pregunta: question, respuesta: answer, tipo: 'select' });
                    }
                });
            });

            // RADIOS
            const radios = form.querySelectorAll('input[type="radio"]');
            radios.forEach((radio, radioIndex) => {
                const question = getUniqueQuestionName(radio, `radio-${radioIndex}`);
                radio.addEventListener('change', function () {
                    if (this.checked) {
                        const answer = this.value ||
                            this.nextElementSibling?.textContent?.trim() ||
                            this.closest('label')?.textContent?.trim() || 'opci√≥n';
                        respuestas[question] = answer;
                        const eventName = `${normalizeEventName(question)}-${normalizeEventName(answer)}`;
                        trackPixelEvent(eventName, { pregunta: question, respuesta: answer, tipo: 'radio' });
                    }
                });
            });

            // CHECKBOXES
            const checkboxes = form.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach((checkbox, checkboxIndex) => {
                const question = getUniqueQuestionName(checkbox, `checkbox-${checkboxIndex}`);
                checkbox.addEventListener('change', function () {
                    const answer = this.value ||
                        this.nextElementSibling?.textContent?.trim() ||
                        this.closest('label')?.textContent?.trim() || 'opci√≥n';
                    const estado = this.checked ? 'seleccionado' : 'deseleccionado';
                    respuestas[question] = this.checked ? answer : '';
                    const eventName = `${normalizeEventName(question)}-${normalizeEventName(answer)}-${estado}`;
                    trackPixelEvent(eventName, { pregunta: question, respuesta: answer, estado, tipo: 'checkbox' });
                });
            });

            // EVENTO FINAL: cuando el formulario se env√≠a
            form.addEventListener('submit', function (e) {
                e.preventDefault();

                // Determinar si el usuario es cualificado o no
                const tipoProyecto = respuestas["Tipo de proyecto:"] || "";
                const empleados = respuestas["Cantidad de empleados en tu empresa:"] || "";
                const cargo = respuestas["¬øCu√°l es tu cargo en la empresa?"] || "";
                const tiempo = respuestas["¬øEn cu√°nto tiempo te gustar√≠a tener tu proyecto en marcha?"] || "";

                let calificacion = "Cualificado";

                // Reglas de descalificaci√≥n
                if (
                    (tipoProyecto === "Otro" && empleados === "Solo yo" && tiempo === "M√°s de 3 meses") ||
                    ((empleados === "De 10 a 50" || empleados === "+50") && cargo === "Otro")
                ) {
                    calificacion = "No Cualificado";
                }

                // Disparar evento resumen
                trackPixelEvent('FormularioCompletado', {
                    ...respuestas,
                    calificacion: calificacion,
                    form_id: this.id || 'sin_id',
                    timestamp: new Date().toISOString()
                });

                console.log("üì© Env√≠o del formulario:", respuestas, "‚û°Ô∏è", calificacion);

                // Si quer√©s redirigir despu√©s del env√≠o, descoment√° esto:
                // this.submit();
            });
        });
    }

    // Configurar eventos de botones
    function setupButtonEvents() {
        const buttons = document.querySelectorAll('button, .btn, [type="submit"], a.btn');
        buttons.forEach(button => {
            button.addEventListener('click', function () {
                const buttonText = this.textContent.trim() ||
                    this.getAttribute('aria-label') ||
                    this.getAttribute('data-text') ||
                    'boton';
                trackPixelEvent('ClickBoton', {
                    button_text: buttonText,
                    button_id: this.id || 'sin_id',
                    page_location: window.location.href
                });
            });
        });
    }

    // Eventos espec√≠ficos
    function setupSpecificEvents() {
        const ctas = {
            'cta-principal': 'CTA Principal',
            'contacto-btn': 'Bot√≥n Contacto',
            'whatsapp-btn': 'Bot√≥n WhatsApp',
            'demo-btn': 'Bot√≥n Demo'
        };

        Object.keys(ctas).forEach(buttonId => {
            const button = document.getElementById(buttonId);
            if (button) {
                button.addEventListener('click', function () {
                    trackPixelEvent('ClickEspecifico', {
                        button_id: buttonId,
                        button_name: ctas[buttonId]
                    });
                });
            }
        });
    }
</script>



</body>
</html>
